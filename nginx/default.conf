server {
    listen       8080;

    location /static/ {
        alias /vol/static/;
    }

    location / {
        # Reject requests with unsupported HTTP method
        if ($request_method !~ ^(GET|POST|HEAD|OPTIONS|PUT|PATCH|DELETE)$) {
            return 405;
        }

        # Only requests matching the whitelist expectations will get sent to the application server
        # 'app' is the name of the container in the local network that nginx forwards traffic to
        proxy_pass          http://app:8000;
        proxy_http_version  1.1;
        proxy_set_header    Upgrade $http_upgrade;
        proxy_set_header    Connection 'upgrade';
        proxy_set_header    Host $host;
        proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_cache_bypass  $http_upgrade;
    }
}
